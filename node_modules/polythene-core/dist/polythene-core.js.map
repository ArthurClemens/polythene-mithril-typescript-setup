{"version":3,"file":"polythene-core.js","sources":["../src/iso.js","../src/animation-event.js","../src/Conditional.js","../src/attrs.js","../src/pointer.js","../src/events.js","../src/multi.js","../src/style.js","../src/transition.js","../src/developer.js","../src/icons.js"],"sourcesContent":["export const isClient = typeof document !== \"undefined\";\nexport const isServer = !isClient;\n","import { isClient } from \"./iso\";\n\nconst evts = {\n  \"animation\": \"animationend\",\n  \"OAnimation\": \"oAnimationEnd\",\n  \"MozAnimation\": \"animationend\",\n  \"WebkitAnimation\": \"webkitAnimationEnd\"\n};\n\nexport const getAnimationEndEvent = () => {\n  if (isClient) {\n    const el = document.createElement(\"fakeelement\");\n    for (let a in evts) {\n      if (el.style[a] !== undefined) {\n        return evts[a];\n      }\n    }\n  }\n};\n","\nconst modes = {\n  hidden:   \"hidden\",\n  visible:  \"visible\",\n  exposing: \"exposing\",\n  hiding:   \"hiding\",\n};\n\nexport const Conditional = {\n  getInitialState: (vnode, createStream) => {\n    const attrs = vnode.attrs;\n    if (!attrs.didHide) {\n      return {};\n    }\n    const visible = attrs.permanent || attrs.show;\n    const mode = createStream(attrs.permanent\n      ? modes.visible\n      : visible\n        ? modes.visible\n        : modes.hidden);\n    return {\n      mode,\n      redrawOnUpdate: createStream.merge([mode])\n    };\n  },\n  onUpdate: ({ state, attrs }) => {\n    if (!attrs.didHide) {\n      return;\n    }\n    const mode = state.mode();\n    if (attrs.permanent) {\n      if (mode === modes.visible && attrs.show) {\n        state.mode(modes.exposing);\n      } else if (mode === modes.exposing && !attrs.show) {\n        state.mode(modes.hiding);\n      }\n    } else {\n      // \"normal\" type\n      if (mode === modes.hidden && attrs.show) {\n        state.mode(modes.visible);\n      } else if (mode === modes.visible && !attrs.show) {\n        state.mode(modes.hiding);\n      }\n    }\n  },\n  view: ({ state, attrs }, { renderer: h }) => {\n    const placeholder = h(\"span\", { className: attrs.placeholderClassName });\n\n    // No didHide callback passed: use normal visibility evaluation\n    if (!attrs.didHide) {\n      return attrs.permanent || attrs.inactive || attrs.show\n        ? h(attrs.instance, attrs)\n        : placeholder;\n    }\n\n    // else: use didHide to reset the state after hiding\n    const mode = state.mode();\n    const visible = mode !== modes.hidden;\n    return visible\n      ? h(attrs.instance, Object.assign(\n        {},\n        attrs,\n        {\n          didHide: args => (\n            attrs.didHide(args),\n            state.mode(attrs.permanent\n              ? modes.visible\n              : modes.hidden\n            )\n          )\n        },\n        mode === modes.hiding && {\n          show: true,\n          hide: true\n        }\n      ))\n      : placeholder; \n  }\n};\n\nConditional.displayName = \"Conditional\";\n","\nconst r = (acc, p) => (acc[p] = 1, acc);\n\n/* \nSeparately handled props:\n- class\n- element\n*/\n\nconst defaultAttrs = [\n  // Universal\n  \"key\",\n  \"style\",\n  \"href\",\n  \"id\",\n  \n  // React\n  \"tabIndex\",\n\n  // Mithril\n  \"tabindex\",\n  \"oninit\",\n  \"oncreate\",\n  \"onupdate\",\n  \"onbeforeremove\",\n  \"onremove\",\n  \"onbeforeupdate\",\n];\n\nexport const filterSupportedAttributes = (attrs, { add: addAttrs = [], remove: removeAttrs = []} = {} ) => {\n  const removeLookup = removeAttrs.reduce(r, {});\n  const supported = defaultAttrs.concat(addAttrs).filter(item => !removeLookup[item]).reduce(r, {});\n  return Object.keys(attrs).reduce((acc, key) => (\n    supported[key]\n      ? acc[key] = attrs[key]\n      : null,\n    acc\n  ), {});\n};\n\nexport const unpackAttrs = attrs =>\n  typeof attrs === \"function\"\n    ? attrs()\n    : attrs;\n\nconst sizeClasses = classes => ({\n  small:   classes.small,\n  regular: classes.regular,\n  medium:  classes.medium,\n  large:   classes.large,\n  fab:     classes.fab,\n});\n\nexport const classForSize = (classes, size = \"regular\") =>\n  sizeClasses(classes)[size];\n\n","import { isClient, isServer } from \"./iso\";\n\nexport const isTouch = isServer\n  ? false\n  : \"ontouchstart\" in document.documentElement;\n\nexport const pointerStartEvent = isTouch\n  ? [\"touchstart\", \"click\"]\n  : [\"click\"];\n\nexport const pointerEndEvent = isTouch\n  ? [\"click\", \"mouseup\"]\n  : [\"mouseup\"];\n\nexport const pointerStartMoveEvent = isTouch\n  ? [\"touchstart\", \"mousedown\"]\n  : [\"mousedown\"];\n\nexport const pointerMoveEvent = isTouch\n  ? [\"touchmove\", \"mousemove\"]\n  : [\"mousemove\"];\n\nexport const pointerEndMoveEvent = isTouch\n  ? [\"touchend\", \"mouseup\"]\n  : [\"mouseup\"];\n\nif (isClient) {\n  document.querySelector(\"html\").classList.add(isTouch ? \"pe-touch\" : \"pe-no-touch\");\n}\n","import { pointerEndEvent } from \"./pointer\";\nimport { isClient } from \"./iso\";\n\nconst listeners = {};\n\n// https://gist.github.com/Eartz/fe651f2fadcc11444549\nexport const throttle = (func, s = 0.05, context = isClient ? window : {}) => {\n  let wait = false;\n  return (...args) => {\n    const later = () => func.apply(context, args);\n    if (!wait) {\n      later();\n      wait = true;\n      setTimeout(() => wait = false, s);\n    }\n  };\n};\n\nexport const subscribe = (eventName, listener, delay) => {\n  listeners[eventName] = listeners[eventName] || [];\n  listeners[eventName].push(delay ? throttle(listener, delay) : listener);\n};\n\nexport const unsubscribe = (eventName, listener) => {\n  if (!listeners[eventName]) {\n    return;\n  }\n  const index = listeners[eventName].indexOf(listener);\n  if (index > -1) {\n    listeners[eventName].splice(index, 1);\n  }\n};\n\nexport const emit = (eventName, event) => {\n  if (!listeners[eventName]) {\n    return;\n  }\n  listeners[eventName].forEach(listener => listener(event));\n};\n\nif (isClient) {\n  window.addEventListener(\"resize\",      e => emit(\"resize\", e));\n  window.addEventListener(\"scroll\",      e => emit(\"scroll\", e));\n  window.addEventListener(\"keydown\",     e => emit(\"keydown\", e));\n  window.addEventListener(pointerEndEvent, e => emit(pointerEndEvent, e));\n}\n","/*\nHelper module to manage multiple items of the same component type.\n*/\n\nimport { isClient } from \"./iso\";\nimport { unpackAttrs } from \"./attrs\";\nimport { emit } from \"./events\";\n\nexport const Multi = ({ options: mOptions, renderer }) => {\n\n  const items = []; // This is shared between all instances of a type (Dialog, Notification, ...)\n  let current;\n  \n  const getInitialState = (vnode, createStream) => {\n    current = createStream(null);\n    return {\n      current,\n      redrawOnUpdate: createStream.merge([current])\n    };\n  };\n\n  /*\n  @param e: { id, eventName }\n  */\n  const onChange = e => {\n    if (!current) {\n      console.error(\"Cannot set state. Did you set a root element like Dialog to show instances?\"); // eslint-disable-line no-console\n    }\n    current(e.id);\n    emit(mOptions.name, e);\n  };\n\n  const itemIndex = id => {\n    const item = findItem(id);\n    return items.indexOf(item);\n  };\n\n  const removeItem = id => {\n    const index = itemIndex(id);\n    if (index !== -1) {\n      items.splice(index, 1);\n      onChange({ id, name: \"removeItem\" });\n    }\n  };\n\n  const replaceItem = (id, newItem) => {\n    const index = itemIndex(id);\n    if (index !== -1) {\n      items[index] = newItem;\n    }\n  };\n\n  const findItem = id => {\n    // traditional for loop for IE10\n    for (let i = 0; i < items.length; i++) {\n      if (items[i].instanceId === id) {\n        return items[i];\n      }\n    }\n  };\n\n  const next = () => {\n    if (items.length) {\n      items[0].show = true;\n    }\n    onChange({ id: items.length ? items[0].instanceId : null, name: \"next\" });\n  };\n\n  const remove = (instanceId = mOptions.defaultId) => {\n    if (mOptions.queue) {\n      items.shift();\n      next();\n    } else {\n      removeItem(instanceId);\n    }\n  };\n\n  const removeAll = () => {\n    items.length = 0;\n    onChange({ id: null, name: \"removeAll\" });\n  };\n\n  const setPauseState = (pause, instanceId) => {\n    const item = findItem(instanceId);\n    if (item) {\n      item.pause = pause;\n      item.unpause = !pause;\n      onChange({ id: instanceId, name: pause ? \"pause\" : \"unpause\" });\n    }\n  };\n\n  const createItem = (itemAttrs, instanceId, spawn) => {\n    let resolveShow;\n    let resolveHide;\n    const attrs = unpackAttrs(itemAttrs);\n\n    const didShow = () => {\n      if (attrs.didShow) {\n        attrs.didShow(instanceId);\n      }\n      onChange({ id: instanceId, name: \"didShow\" });\n      return resolveShow(instanceId);\n    };\n    const showPromise = new Promise(resolve => \n      resolveShow = resolve\n    );\n\n    const didHide = () => {\n      if (attrs.didHide) {\n        attrs.didHide(instanceId);\n      }\n      onChange({ id: instanceId, name: \"didHide\" });\n      remove(instanceId);\n      return resolveHide(instanceId);\n    };\n\n    const hidePromise = new Promise(resolve => resolveHide = resolve);\n\n    return Object.assign(\n      {},\n      mOptions,\n      {\n        instanceId,\n        spawn,\n        attrs: itemAttrs,\n        show: mOptions.queue ? false : true,\n        showPromise,\n        hidePromise,\n        didShow,\n        didHide\n      }\n    );\n  };\n\n  const count = () => items.length;\n  const pause = (instanceId = mOptions.defaultId) => setPauseState(true, instanceId);\n  const unpause = (instanceId = mOptions.defaultId) => setPauseState(false, instanceId);\n\n  const show = (attrs = {}, spawnOpts = {}) => {\n    const instanceId = spawnOpts.id || mOptions.defaultId;\n    const spawn = spawnOpts.spawn || mOptions.defaultId;\n    const item = createItem(attrs, instanceId, spawn);\n    onChange({ id: instanceId, name: \"show\" });\n    if (mOptions.queue) {\n      items.push(item);\n      if (items.length === 1) {\n        next();\n      }\n    } else {\n      const storedItem = findItem(instanceId);\n      if (!storedItem) {\n        items.push(item);\n      } else {\n        replaceItem(instanceId, item);\n      }\n    }\n    return item.showPromise;\n  };\n\n  const hide = (spawnOpts = {}) => {\n    const instanceId = spawnOpts.id || mOptions.defaultId;\n    const item = mOptions.queue && items.length\n      ? items[0]\n      : findItem(instanceId);\n    if (item) {\n      item.hide = true;\n    }\n    onChange({ id: instanceId, name: \"hide\" });\n    return item\n      ? item.hidePromise\n      : Promise.resolve(instanceId);\n  };\n\n  const clear = removeAll;\n\n  const view = ({ attrs }) => {\n    const spawn = attrs.spawn || mOptions.defaultId;\n    const candidates = items.filter(item => \n      item.show && item.spawn === spawn\n    );\n    if (mOptions.htmlShowClass && isClient && document.documentElement) {\n      document.documentElement.classList[candidates.length ? \"add\" : \"remove\"](mOptions.htmlShowClass);\n    }\n    return !candidates.length\n      ? renderer(mOptions.placeholder) // placeholder because we cannot return null\n      : renderer(mOptions.holderSelector,\n        {\n          className: attrs.position === \"container\"\n            ? \"pe-multiple--container\"\n            : \"pe-multiple--screen\"\n        },\n        candidates.map(itemData => {\n          return renderer(mOptions.instance, Object.assign(\n            {},\n            {\n              fromMultipleClassName: mOptions.className,\n              fromMultipleClear: clear,\n              fromMultipleDidHide: itemData.didHide,\n              fromMultipleDidShow: itemData.didShow,\n              hide: itemData.hide,\n              holderSelector: mOptions.holderSelector,\n              instanceId: itemData.instanceId,\n              key: itemData.key,\n              pause: itemData.pause,\n              show: itemData.show,\n              spawnId: spawn,\n              transitions: mOptions.transitions,\n              unpause: itemData.unpause,\n            },\n            unpackAttrs(itemData.attrs)\n          ));\n        })\n      );\n  };\n\n  return {\n    clear,\n    count,\n    getInitialState,  \n    hide,\n    pause,\n    remove,\n    show,\n    unpause,\n    view,\n  };\n};\n\nMulti.displayName = \"Multi\";\n","\nexport const getStyle = ({ element, selector, pseudoSelector, prop }) => {\n  const el = selector\n    ? element.querySelector(selector)\n    : element;\n  if (!el) {\n    return;\n  }\n  return el.currentStyle\n    ? el.currentStyle[prop]\n    : window.getComputedStyle\n      ? document.defaultView.getComputedStyle(el, pseudoSelector).getPropertyValue(prop)\n      : null;\n};\n\nexport const stylePropCompare = ({ element, selector, pseudoSelector, prop, equals, contains }) => {\n  const el = selector\n    ? element.querySelector(selector)\n    : element;\n  if (!el) {\n    return false;\n  }\n  if (equals !== undefined) {\n    return equals === document.defaultView.getComputedStyle(el, pseudoSelector).getPropertyValue(prop);\n  }\n  if (contains !== undefined) {\n    return document.defaultView.getComputedStyle(el, pseudoSelector).getPropertyValue(prop).indexOf(contains) !== -1;\n  }\n};\n\nexport const isRTL = ({ element = document, selector }) => \n  stylePropCompare({ element, selector, prop: \"direction\", equals: \"rtl\" });\n\nexport const styleDurationToMs = durationStr => {\n  const parsed = parseFloat(durationStr) * (durationStr.indexOf(\"ms\") === -1 ? 1000 : 1);\n  return isNaN(parsed)\n    ? 0\n    : parsed;\n};","/*\nGeneric show/hide transition module\n*/\n\nimport { isClient } from \"./iso\";\nimport { styleDurationToMs } from \"./style\";\n\n// defaults\nconst DEFAULT_DURATION = .240;\nconst DEFAULT_DELAY =    0;\n// const TRANSITION =    \"both\";\n\n// See: transition\nexport const show = opts =>\n  transition(opts, \"show\");\n\nexport const hide = opts =>\n  transition(opts, \"hide\");\n\n/*\nopts:\n- el\n- duration\n- delay\n- showClass\n- transitionClass\n- before\n- show\n- hide\n- after\n- timingFunction\n\n- state (show, hide)\n*/\nconst transition = (opts, state) => {\n  const el = opts.el;\n  if (!el) {\n    return Promise.resolve();\n  } else {\n    return new Promise(resolve => {\n      const style = el.style;\n      const computedStyle = isClient\n        ? window.getComputedStyle(el)\n        : {};\n      const duration = opts.hasDuration\n        ? opts.duration * 1000.0\n        : styleDurationToMs(computedStyle.transitionDuration);\n      const delay = opts.hasDelay\n        ? opts.delay * 1000.0\n        : styleDurationToMs(computedStyle.transitionDelay);\n      const timingFunction = opts.timingFunction || computedStyle.transitionTimingFunction;\n\n      if (opts.transitionClass) {\n        const transitionClassElement = opts.transitionClassElement || el;\n        transitionClassElement.classList.add(opts.transitionClass);\n      }\n\n      const before = () => {\n        style.transitionDuration = \"0ms\";\n        style.transitionDelay = \"0ms\";\n        opts.before();\n      };\n\n      const maybeBefore = (opts.before && state === \"show\")\n        ? before\n        : (opts.before && state === \"hide\")\n          ? before\n          : null;\n\n      const after = opts.after\n        ? () => opts.after()\n        : null;\n\n      const applyTransition = () => {\n        style.transitionDuration = duration + \"ms\";\n        style.transitionDelay = delay + \"ms\";\n\n        if (timingFunction) {\n          style.transitionTimingFunction = timingFunction;\n        }\n        if (opts.showClass) {\n          const showClassElement = opts.showClassElement || el;\n          showClassElement.classList[(state === \"show\") ? \"add\" : \"remove\"](opts.showClass);\n        }\n        if (opts.transition) {\n          opts.transition();\n        }\n      };\n\n      const doTransition = () => {\n        applyTransition();\n        setTimeout(() => {\n          if (after) {\n            after();\n          }\n          if (opts.transitionClass) {\n            const transitionClassElement = opts.transitionClassElement || el;\n            transitionClassElement.classList.remove(opts.transitionClass);\n            el.offsetHeight; // force reflow\n          }\n          resolve();\n        }, duration + delay);\n      };\n\n      const maybeDelayTransition = () => {\n        if (duration === 0) {\n          doTransition();\n        } else {\n          setTimeout(doTransition, 0);\n        }\n      };\n\n      if (maybeBefore) {\n        maybeBefore();\n        el.offsetHeight; // force reflow\n        setTimeout(() => {\n          maybeDelayTransition();\n        }, 0);\n      } else {\n        maybeDelayTransition();\n      }\n    });\n  }\n};\n\nexport const transitionComponent = ({ isShow, state, attrs, domElements, beforeTransition, afterTransition, showClass, transitionClass }) => {\n  if (state.transitioning()) {\n    return Promise.resolve();\n  }\n  state.transitioning(true);\n  state.visible(isShow ? true : false);\n  if (beforeTransition) {\n    beforeTransition();\n  }\n  const duration = attrs[isShow ? \"showDuration\" : \"hideDuration\"];\n  const delay = attrs[isShow ? \"showDelay\" : \"hideDelay\"];\n  const timingFunction = attrs[isShow ? \"showTimingFunction\" : \"hideTimingFunction\"];\n  const transitions = attrs.transitions;\n  const fn = isShow ? show : hide;\n  const opts1 = Object.assign({},\n    attrs,\n    domElements,\n    {\n      showClass,\n      transitionClass,\n      duration,\n      delay,\n      timingFunction\n    }\n  );\n  const opts2 = Object.assign({},\n    opts1,\n    transitions && transitions[isShow ? \"show\" : \"hide\"](opts1)\n  );\n  const opts3 = Object.assign({},\n    opts2,\n    {\n      duration: opts2.duration !== undefined\n        ? opts2.duration\n        : DEFAULT_DURATION,\n      hasDuration: opts2.duration !== undefined,\n      delay: opts2.delay !== undefined\n        ? opts2.delay\n        : DEFAULT_DELAY,\n      hasDelay: opts2.delay !== undefined,\n    }\n  );\n  return fn(opts3).then(() => {\n    const id = state.instanceId;\n    if (attrs[isShow ? \"fromMultipleDidShow\" : \"fromMultipleDidHide\"]) {\n      attrs[isShow ? \"fromMultipleDidShow\" : \"fromMultipleDidHide\"](id); // when used with Multiple; this will call attrs.didShow / attrs.didHide\n    } else if (attrs[isShow ? \"didShow\" : \"didHide\"]) {\n      attrs[isShow ? \"didShow\" : \"didHide\"](id); // when used directly\n    }\n    if (afterTransition) {\n      afterTransition();\n    }\n    state.transitioning(false);\n  });\n};\n","\nexport const deprecation = (component, { option, newOption, newComponent }) => (\n  option && console.warn(`${component}: option '${option}' is deprecated and will be removed in later versions. Use '${newOption}' instead.`), // eslint-disable-line no-console\n  newComponent && !newOption && console.warn(`${component}: this component is deprecated and will be removed in later versions. Use '${newComponent}' instead.`), // eslint-disable-line no-console\n  newComponent && newOption && console.warn(`${component}: this component is deprecated and will be removed in later versions. Use '${newComponent}' with option '${newOption}' instead.`) // eslint-disable-line no-console\n);\n","\nexport const iconDropdownUp = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" id=\\\"dd-up-svg\\\" width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\"><path d=\\\"M7 14l5-5 5 5z\\\"/></svg>\";\nexport const iconDropdownDown = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" id=\\\"dd-down-svg\\\" width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\"><path d=\\\"M7 10l5 5 5-5z\\\"/></svg>\";\n"],"names":["isClient","document","isServer","evts","getAnimationEndEvent","el","createElement","a","style","undefined","modes","hidden","visible","exposing","hiding","Conditional","getInitialState","vnode","createStream","attrs","didHide","permanent","show","mode","redrawOnUpdate","merge","onUpdate","state","view","h","renderer","placeholder","className","placeholderClassName","inactive","instance","args","hide","displayName","r","acc","p","defaultAttrs","filterSupportedAttributes","add","addAttrs","remove","removeAttrs","removeLookup","reduce","supported","concat","filter","item","Object","keys","key","unpackAttrs","sizeClasses","small","classes","regular","medium","large","fab","classForSize","size","isTouch","documentElement","pointerStartEvent","pointerEndEvent","pointerStartMoveEvent","pointerMoveEvent","pointerEndMoveEvent","querySelector","classList","listeners","throttle","func","s","context","window","wait","later","apply","setTimeout","subscribe","eventName","listener","delay","push","unsubscribe","index","indexOf","splice","emit","event","forEach","addEventListener","e","Multi","mOptions","options","items","current","onChange","console","error","id","name","itemIndex","findItem","removeItem","replaceItem","newItem","i","length","instanceId","next","defaultId","queue","shift","removeAll","setPauseState","pause","unpause","createItem","itemAttrs","spawn","resolveShow","resolveHide","didShow","showPromise","Promise","resolve","hidePromise","_extends","count","spawnOpts","storedItem","clear","candidates","htmlShowClass","holderSelector","position","map","fromMultipleClassName","fromMultipleClear","fromMultipleDidHide","itemData","fromMultipleDidShow","spawnId","transitions","getStyle","element","selector","pseudoSelector","prop","currentStyle","getComputedStyle","defaultView","getPropertyValue","stylePropCompare","equals","contains","isRTL","styleDurationToMs","parsed","parseFloat","durationStr","isNaN","DEFAULT_DURATION","DEFAULT_DELAY","transition","opts","computedStyle","duration","hasDuration","transitionDuration","hasDelay","transitionDelay","timingFunction","transitionTimingFunction","transitionClass","transitionClassElement","before","maybeBefore","after","applyTransition","showClass","showClassElement","doTransition","offsetHeight","maybeDelayTransition","transitionComponent","isShow","domElements","beforeTransition","afterTransition","transitioning","fn","opts1","opts2","opts3","then","deprecation","component","option","newOption","newComponent","warn","iconDropdownUp","iconDropdownDown"],"mappings":"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"}